#!/bin/bash

if (($# == 1)) && [[ "$1" == "--bash-completion" ]]; then
	complete -c "$BASH_SOURCE" "$(basename -- "$BASH_SOURCE")"
	return
fi

name=$(basename -- "$0")
usage() {
		cat <<EOF
Usage: $name executablefile

Edit executable file.
EOF
}

if (($# == 0)); then
	usage
	exit 1
fi
if ! l=$(which "$1"); then
	echo "$name: ERROR: No executable found $l";
	exit 1
fi
for i in $(cut -d: -f2- <<<"$l"); do
	if [[ ! -x "$i" ]]; then
		l=$i;
		break
	fi
done
if [[ -z "$l" ]]; then
	echo "$name: ERROR: No executable found 2";
	exit 1
fi
set -x
${EDITOR:-vim} "$l"
