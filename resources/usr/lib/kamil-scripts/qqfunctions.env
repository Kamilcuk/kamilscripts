#!/bin/bash

DIR() {
	# returns directory of $0
	echo -n "$(readlink -f $(dirname $(readlink -f "$0")))"
}
pacman_packages_store.sh() {
    set -x
    pacman -Qq > /root/pkglist-$(date +%Y-%m-%dT%H:%M:%S).txt
    set +x
}
pacman_packages_restore.sh() {
    if test -z "$1"; then
        echo "Ta komenda robi to:"
        echo 'pacman -Rsu $(comm -23 <(pacman -Qq|sort) <(sort $1))'
        echo ' lista pakietów została zapisana w katalogu /root/pkglist-datacostam.txt'
    else
        pacman -Rsu $(comm -23 <(pacman -Qq|sort) <(sort $1))
    fi
}
pacman_list_all_edited_and_new_files_in_directories.sh() {
    local tmp1 tmp2
    if [ $# -eq 0 ]; then
        echo "No arguments given - listing only /etc!" >&2
        set -- /etc
    fi
    tmp1=$(for i in "$@"; do echo "^$i\|"; done | sed 's/\\|$//')
    tmp1=$(pacman --query --list -q | cut -d' ' -f2- | grep "$tmp1" | xargs grep -Il "" 2>/dev/null)
    tmp2=$(find "$@" -type f)
    comm -13 <(echo "$tmp1" | sort) <(echo "$tmp2" | sort)
}
