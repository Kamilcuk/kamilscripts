####
# Organization: netemera.com
# Maintainer: Kamil Cukrowski <kamilcukrowski@gmail.com>
# cross-build with: CARCH="armv7h" makepkg  --nodeps --clean -f

pkgbase=kamil-scripts
pkgname=kamil-scripts
pkgver="$(git describe --tags $(git rev-list --tags --max-count=1))"
pkgrel="1"
epoch=
pkgdesc=""
arch=( "any" )
url="www.dyzio.pl"
license=('GPL')
groups=()
depends=( "bash>=4" "run-parts" )
makedepends=( "rsync" )
checkdepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=$pkgname.install
changelog=
source=()
noextract=()
md5sums=()
validpgpkeys=()

build() {
	../rsync_all_pkg_resources.sh
}	

package() {
	# all files from srcdir with -g root -o root, dirs with mode 0755
	# executable files with mode 0755, non-executable files - 0644

	while read path; do
		opts=" -g root -o root "
		if   [ -d "$path" ]; then
			echo "Creating directory    $path"
			install $opts -m 0755 -d $pkgdir/$path
		elif [ -x "$path" ]; then
			echo "Installing executable $path"
			install $opts -m 0755 $srcdir/$path $pkgdir/$path
		elif [ -L "$path" ]; then
			echo "Installing symlink    $path"
			cp -a $srcdir/$path $pkgdir/$path
		elif [ -s "$path" ]; then
			echo "Installing file       $path"
			install $opts -m 0644 $srcdir/$path $pkgdir/$path
		else
			echo "No install for        $path !!!"
		fi
	done <<< "$(cd $srcdir && find .)"
}
